<!DOCTYPE html>
<html>
  <head>
    <script src="https://js.pusher.com/3.0/pusher.min.js"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Mr Pushy Pusherson</title>
  </head>
  <body>
    <video id="v" width="300" height="300"></video>
    <canvas id="c" style="positon: absolute; top: 0; left: 0;" width="300" height="300"></canvas>
    <script>
      var pusher = new Pusher('087e104eb546157304a9', {cluster:'eu'});
      var button = pusher.subscribe('button-27');

      navigator.getUserMedia = navigator.getUserMedia ||
        navigator.webkitGetUserMedia ||
        navigator.mozGetUserMedia;

      function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min)) + min;
      }

      var rotationBase = 90;
      var rotations = [0, 1, 2, 3, 4];
      var canvas = document.getElementById("c");

      navigator.getUserMedia({ video: { width: 1280, height: 720 } },
        function(stream) {
          var video = document.getElementById("v");

          video.src = window.webkitURL.createObjectURL(stream);
          video.play();
        },
        function(err) {
          console.log("The following error occurred: " + err.name);
        }
      );

      button
        .bind('press', function(data) {
          canvas.getContext("2d").drawImage(video, 0, 0, 300, 300, 0, 0, 300, 300);
        });

      button
        .bind('release', function(data) {
          window.navigator.vibrate(0);
        });
    </script>
  </body>
</html>
